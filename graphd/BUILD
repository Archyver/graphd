# Description:
#   graphd - the metaweb graph repository

package(default_visibility = ["//visibility:public"])

cc_library(
    name = "graphdh",
    hdrs = [
        "graphd.h",
        "graphd-ast.h",
        "graphd-ast-debug.h",
        "graphd-build-version.c",
        "graphd-hash.h",
        "graphd-islink.h",
        "graphd-iterator-and.h",
        "graphd-iterator-isa.h",
        "graphd-read.h",
        "graphd-sabotage.h",
        "graphd-snapshot.h",
        "graphd-version.h",
        "graphd-write.h",
    ],
)

cc_binary(
    name = "graphd",
    srcs = [
        "graphd.c",
        "graphd-access.c",
        "graphd-assignment.c",
        "graphd-ast.c",
        "graphd-ast-debug.c",
        "graphd-bad-cache.c",
        "graphd-build-version.c",
        "graphd-checkcache.c",
        "graphd-checkpoint.c",
        "graphd-client-replica.c",
        "graphd-comparator.c",
        "graphd-comparator-case.c",
        "graphd-comparator-datetime.c",
        "graphd-comparator-default.c",
        "graphd-comparator-number.c",
        "graphd-comparator-octet.c",
        "graphd-constraint.c",
        "graphd-constraint-clause.c",
        "graphd-constraint-cursor.c",
        "graphd-constraint-iterator.c",
        "graphd-constraint-or.c",
        "graphd-constraint-path.c",
        "graphd-constraint-setsize.c",
        "graphd-constraint-signature.c",
        "graphd-constraint-to-string.c",
        "graphd-cost.c",
        "graphd-cost-parse.c",
        "graphd-database.c",
        "graphd-dateline.c",
        "graphd-dump.c",
        "graphd-guid-constraint.c",
        "graphd-guid-set.c",
        "graphd-idle.c",
        "graphd-instance-id.c",
        "graphd-interface-id.c",
        "graphd-islink.c",
        "graphd-islink-group.c",
        "graphd-islink-intersect.c",
        "graphd-islink-job.c",
        "graphd-islink-key.c",
        "graphd-islink-side.c",
        "graphd-islink-status.c",
        "graphd-islink-type.c",
        "graphd-iterate.c",
        "graphd-iterator.c",
        "graphd-iterator-and.c",
        "graphd-iterator-and-check.c",
        "graphd-iterator-and-freeze.c",
        "graphd-iterator-and-optimize.c",
        "graphd-iterator-and-process-state.c",
        "graphd-iterator-and-run.c",
        "graphd-iterator-and-statistics.c",
        "graphd-iterator-cache.c",
        "graphd-iterator-dump.c",
        "graphd-iterator-fixed.c",
        "graphd-iterator-idset.c",
        "graphd-iterator-isa.c",
        "graphd-iterator-isa-storable.c",
        "graphd-iterator-islink.c",
        "graphd-iterator-linksto.c",
        "graphd-iterator-or.c",
        "graphd-iterator-prefix.c",
        "graphd-iterator-resource.c",
        "graphd-iterator-sort.c",
        "graphd-iterator-state.c",
        "graphd-iterator-vip.c",
        "graphd-iterator-vrange.c",
        "graphd-iterator-without.c",
        "graphd-key.c",
        "graphd-match.c",
        "graphd-pattern.c",
        "graphd-pattern-frame.c",
        "graphd-predictable.c",
        "graphd-property.c",
        "graphd-read.c",
        "graphd-read-base.c",
        "graphd-read-base-evaluate.c",
        "graphd-read-one.c",
        "graphd-read-or.c",
        "graphd-read-set.c",
        "graphd-read-set-count.c",
        "graphd-read-set-cursor.c",
        "graphd-read-set-defer.c",
        "graphd-read-set-estimate.c",
        "graphd-replica.c",
        "graphd-request.c",
        "graphd-request-input.c",
        "graphd-request-output.c",
        "graphd-request-run.c",
        "graphd-request-size-max.c",
        "graphd-request-timer.c",
        "graphd-request-xstate.c",
        "graphd-restore.c",
        "graphd-runtime-statistics.c",
        "graphd-sabotage.c",
        "graphd-semantic.c",
        "graphd-session.c",
        "graphd-set.c",
        "graphd-shutdown.c",
        "graphd-sleep.c",
        "graphd-smp.c",
        "graphd-smp-config.c",
        "graphd-smp-forward.c",
        "graphd-smp-passthrough.c",
        "graphd-smp-startup.c",
        "graphd-snapshot.c",
        "graphd-sort.c",
        "graphd-sort-compile.c",
        "graphd-sort-root.c",
        "graphd-stack.c",
        "graphd-startup.c",
        "graphd-status.c",
        "graphd-strerror.c",
        "graphd-string-constraint.c",
        "graphd-suspend-a-read.c",
        "graphd-sync.c",
        "graphd-text-compare.c",
        "graphd-timestamp.c",
        "graphd-token.c",
        "graphd-type.c",
        "graphd-unique.c",
        "graphd-value.c",
        "graphd-variable.c",
        "graphd-variable-analysis.c",
        "graphd-variable-declaration.c",
        "graphd-verify.c",
        "graphd-write.c",
        "graphd-write-annotate-anchor.c",
        "graphd-write-annotate-keyed.c",
        "graphd-write-annotate-pointed.c",
        "graphd-write-check-unique.c",
        "graphd-writethrough.c",
        "graphd-xstate.c",
    ],
    copts = [
        "$(STACK_FRAME_UNLIMITED)",
        "-g",
        "-w",
    ],
    deps = [
        ":graphdh",
        "//libaddb",
        "//libcl",
        "//libcm",
        "//libes",
        "//libgdp",
        "//libgraph",
        "//libpdb",
        "//libsrv",
    ],
)
